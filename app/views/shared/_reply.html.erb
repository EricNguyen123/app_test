<% Micropost.where(micropost_id: micropost.id).reverse_each do |comment|%>
    <div class="blog-comment">
        <div class="item-comment" id="<%= dom_id comment %>">
            <p class="content-comment">
                <%= link_to gravatar_for(User.find_by(id: comment.user_id), size: 26), User.find_by(id: comment.user_id) %>
                <strong class="user">
                    <%= link_to User.find_by(id: comment.user_id).name, User.find_by(id: comment.user_id) %>
                </strong>
                <span class="time-comment"><%= comment.created_at.to_s[0...10]%></span>
                <br>
                <%= comment.content %>
                <br>
                <%= link_to image_tag(comment.display_image,  width: "100", class: "img-post"), comment.image if comment.image.attached?%>
            </p>
            <div class="footer-cmt">
                <span class="timestamp">
                    Comment <%= time_ago_in_words(comment.created_at) %> ago.
                </span> 
                <div class="box-btn-option">
                    <div class="btn-reply btn-reply-<%= dom_id comment %>" id="<%= dom_id comment %>">
                        <span class="btn-content">Reply</span>
                    </div>
                    <% if current_user?(User.find_by(id: comment.user_id))%>
                        <div class="btn-edit btn-edit-<%= dom_id comment %>" id="<%= dom_id comment %>">
                            <span class="btn-content">Edit</span>
                        </div>
                        <div class="delete-comment">
                            <%= link_to "Delete", comment, data: { turbo_method: :delete, confirm: "You sure?" }  %>
                        </div>
                    <% end %>
                </div>
            </div>
        </div>
        <div class="reply-list reply-list-<%= dom_id comment %>">
            <% if Micropost.find_by(micropost_id: comment.id)%>
                <div class="reply-comment reply-comment-<%= dom_id comment %>" id="reply-comment-<%= dom_id comment %>">
                    <%= render "shared/reply", micropost: comment%>
                </div>
            <%end%>
            <div class="box-reply box-reply-<%= dom_id comment %> box-rep-cmt box-rep-form">
                <%= render 'shared/reply_form', micropost: comment, comment: @micropost %>
            </div>
            <div class="box-edit box-edit-<%= dom_id comment %> box-edit-cmt box-edit-form">
                <%= render 'shared/edit_form', micropost: comment, comment: @micropost %>
            </div>
        </div>
        <script type="text/javascript"> 
            $('.btn-reply-<%=j dom_id(comment) %>').on("click", ()=>{
                $('.box-rep-cmt').addClass('box-reply');
                $('.box-edit-cmt').addClass('box-edit');
                $('.box-reply-<%=j dom_id(comment) %>').removeClass('box-reply');
                $('.box-reply-<%=j dom_id(comment) %>').css({
                    display: 'flex !important'
                });
                console.log('<%= j comment.id %>');
                $('#<%= j comment.id %>').val("");
            });

            $('.btn-edit-<%=j dom_id(comment) %>').on("click", ()=>{
                $('.box-edit-cmt').addClass('box-edit');
                $('.box-rep-cmt').addClass('box-reply');
                $('.box-edit-<%=j dom_id(comment) %>').removeClass('box-edit');
                $('.box-edit-<%=j dom_id(comment) %>').css({
                    display: 'flex !important'
                });
            })
        </script>
    </div>
<%end%>

